# 運送管理（超商 / 宅配）需求文件

## 1. 模組定位與目標

運送管理模組負責處理「訂單成立後的出貨資訊與物流流程」，  
支援 **超商取貨** 與 **宅配到府** 兩大類型，並提供：

- 玩家端填寫 / 確認運送資訊
- 店家後台進行出貨處理
- 訂單狀態與物流狀態同步顯示

本模組僅負責「物流資訊與狀態管理」，  
不處理金流、不介入玩家與店家之間的溝通。

---

## 2. 運送方式類型

系統需支援以下基本運送方式：

### 2.1 超商取貨

- 支援常見超商類型（如：7-11、全家）
- 玩家於送出訂單時選擇超商取貨
- 需記錄：
  - 超商類型
  - 門市名稱
  - 門市代碼（概念層級）
  - 門市地址

> 實際串接超商 API 可延後，需求層僅保留擴充空間

---

### 2.2 宅配到府

- 玩家填寫或選擇宅配地址
- 需記錄：
  - 收件人姓名
  - 聯絡電話
  - 收件地址
- 若玩家已有個人資料（地址資訊）：
  - 可直接帶入作為預設選項
  - 玩家仍可自行修改

---

## 3. 玩家端運送行為

玩家在「賞品盒送出訂單」時，需完成以下動作：

- 選擇運送方式（超商 / 宅配）
- 填寫或確認運送資訊
- 確認後送出訂單

### 玩家權限限制

- 玩家 **僅能在訂單成立前設定運送資訊**
- 訂單成立後：
  - 玩家僅能查看運送資訊與狀態
  - 不可自行修改
  - 不可自行取消訂單

---

## 4. 店家後台運送管理功能

### 4.1 訂單運送資訊檢視

店家可於後台查看：
- 訂單所選運送方式
- 完整收件資訊
- 玩家備註（若有）

---

### 4.2 出貨處理

店家可在後台進行以下操作：
- 標記訂單為「準備出貨」
- 填寫出貨相關資訊（如物流單號概念）
- 標記為「已出貨」

---

## 5. 運送狀態流轉（狀態變更）

每一筆訂單需具備明確的物流狀態概念，至少包含：

- 待出貨
- 準備出貨
- 已出貨
- 已完成

### 狀態原則

- 狀態僅能單向前進，不可回退
- 狀態變更僅能由後台操作
- 玩家僅能查看狀態，不可修改

---

## 6. 訂單取消與物流關聯規則

- 訂單僅能在「尚未出貨」前取消
- 一旦訂單進入「已出貨」狀態：
  - 不可取消
  - 不可退換貨
- 取消訂單僅能由後台操作
- 玩家若要取消：
  - 需自行聯絡店家
  - 系統不提供玩家端取消功能

---

## 7. 平台角色與介入原則

- 平台不介入物流實際流程
- 平台僅負責：
  - 系統功能提供
  - 訂單與物流資料的管理與查詢
- 玩家與店家間的物流問題：
  - 由雙方自行處理

---

## 8. 與其他模組的關聯

- 與「賞品盒（購物車）」模組關聯：
  - 玩家選擇出貨時需指定運送方式
- 與「訂單管理」模組關聯：
  - 訂單狀態與物流狀態同步顯示
- 與「金流管理」模組關聯：
  - 僅在付款完成後才允許進入出貨流程

---

## 9. 設計原則總結

- 運送資訊由玩家在訂單成立前確認
- 訂單成立後運送資訊不可變更
- 出貨狀態不可逆
- 店家為出貨流程唯一操作方
- 平台不介入玩家與店家的物流行為

