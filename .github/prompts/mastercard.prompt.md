# 金流管理（儲值 / 點數系統）需求文件 v1.0

## 一、模組定位

本模組負責平台內所有「金錢相關行為」，但 **不直接對應訂單金額**。

核心原則：
- 玩家消費的是「平台點數」
- 點數來自「儲值」
- 抽獎與訂單僅消耗點數，不與實體金流直接綁定

---

## 二、金流設計核心概念

### 2.1 點數類型

平台內存在兩種點數：

1. **Gold（儲值金）**
   - 玩家以真實金錢購買
   - 為主要消費點數
   - 可用於所有抽獎商品

2. **Bonus（紅利金）**
   - 由平台或店家活動贈送
   - 可用於抽獎
   - 不可轉現、不可退費

---

## 三、儲值行為定義

### 3.1 儲值方式

- 玩家以信用卡進行儲值
- 金流體系：
  - Mastercard（預設）
- 儲值行為僅發生於前台玩家

### 3.2 儲值方案

平台可設定多種儲值方案，例如：

- 固定金額儲值
- 儲值加贈 Bonus
- 限時活動儲值方案

⚠️ 儲值方案屬於平台設定，玩家不可自行輸入金額。

---

## 四、點數使用規則

### 4.1 點數扣除優先順序

- 抽獎消費時：
    1. 優先扣除 Gold

（此順序可於後台調整，但 v1.0 固定）

---

## 五、抽獎與點數關係

- 每一次抽獎：
  - 直接扣除點數
  - 不產生訂單
- 抽獎失敗（如餘額不足）：
  - 不可進行抽獎
  - 不產生任何紀錄

---

## 六、賞品回收與點數返還

### 6.1 賞品回收機制

- 玩家可將「已抽中但未出貨」的獎品：
  - 回收為 Bonus（若平台允許）
- 回收後：
  - 不可逆
  - 不可恢復為實體獎品

### 6.2 回收點數規則

- 回收所得點數：
  - 僅能為 Bonus
  - 不可為 Gold
  - 不可提現

---

## 七、點數紀錄（帳務概念）

### 7.1 點數變動類型

平台需完整記錄以下行為：

- 儲值增加 Gold
- 活動贈送 Bonus
- 抽獎扣點
- 賞品回收返 Bonus
- 系統調整（僅 Admin）

### 7.2 玩家可查看紀錄

玩家前台可查看：

- 點數異動時間
- 異動類型
- 異動數量
- 異動後餘額

---

## 八、後台金流管理（Admin）

### 8.1 平台管理者權限

Admin 可執行：

- 查看全站儲值統計
- 查看玩家儲值紀錄
- 設定儲值方案
- 設定 Bonus 發放規則
- 手動調整玩家點數（需記錄原因）

---

## 九、店家與金流的關係（重要）

- 店家 **不直接接觸金流**
- 店家收入：
  - 由平台後續結算
  - 不屬於本模組範圍
- 店家後台：
  - 僅能看到「抽獎 / 訂單 / 營收報表」
  - 看不到玩家的實際儲值金額

---

## 十、退款與取消原則（v1.0）

- 儲值完成後：
  - 不支援退款
- 抽獎消費：
  - 不可逆
- 訂單取消：
  - 不影響已消耗點數

---

## 十一、安全與風控原則

- 所有點數異動：
  - 必須可追蹤
  - 不可直接修改餘額
- 系統需防止：
  - 重複扣點
  - 競態條件導致點數異常

---

## 十二、版本邊界（v1.0 不包含）

以下不納入本版本：

- 提現功能
- 玩家間點數轉贈
- 分潤自動結算
- 多金流通道

---

## 十三、版本說明

- 本文件為金流管理 v1.0
- 為平台財務與點數邏輯的唯一依據文件
