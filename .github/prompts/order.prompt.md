你是一位系統設計師，負責設計一個用於管理抽獎結果、獎品配送與訂單處理的平台。請遵循以下需求：

1. **抽獎結果與獎品箱**：
    - 抽獎結果不直接生成訂單。
    - 使用一個名為「獎品箱」的中介容器，存放玩家贏得但尚未配送的獎品。
    - 玩家可以決定從獎品箱中選擇哪些獎品進行配送。

2. **訂單生成規則**：
    - 訂單僅在玩家選擇配送獎品時生成。
    - 一個訂單可以包含從獎品箱中選擇的多個獎品。
    - 訂單基於配送行為生成，而非抽獎次數。

3. **商家後台**：
    - 商家只能查看與其店鋪相關的訂單。
    - 訂單是店鋪專屬的，不能合併來自多個店鋪的獎品。
    - 商家可以查看訂單詳情，包括玩家信息、獎品詳情、訂單狀態與創建時間。
    - 商家負責配送，但無法修改訂單規則或狀態。

4. **玩家前台**：
    - 玩家可以查看其獎品箱，列出所有未配送的獎品，包含店鋪、產品與獎品信息。
    - 玩家可以：
      - 選擇獎品進行配送。
      - 創建配送訂單。
      - 填寫並確認收件人信息。
      - 查看訂單狀態。
    - 玩家不能：
      - 取消訂單。
      - 在訂單創建後修改訂單內容。
      - 要求退貨或換貨。

5. **訂單狀態流程**：
    - 定義基本狀態：已創建、準備配送、已配送、已完成與已取消（僅限未配送時）。
    - 平台不介入玩家與商家之間的糾紛或溝通。

6. **平台角色**：
    - 平台提供訂單記錄與狀態顯示的機制。
    - 平台不處理糾紛、取消或協調玩家與商家之間的事宜。

7. **不可逆的訂單規則**：
    - 訂單不接受退貨或換貨。
    - 僅管理員可取消訂單，且僅限未配送的訂單。
    - 玩家需直接聯繫商家提出取消請求。

8. **核心原則**：
    - 抽獎結果 ≠ 訂單。
    - 配送行為是交易的觸發點。
    - 獎品箱作為緩衝，減少衝動配送與糾紛。
    - 店鋪專屬的訂單隔離確保收入準確歸屬。
    - 平台執行規則並維護記錄，但不介入交易。

# 後台訂單管理（Order Management）需求文件

## 1. 模組定位與目標

後台訂單管理模組負責管理「由玩家賞品盒送出後所產生的訂單」，  
提供 **店家後台** 與 **平台管理後台（僅查詢）** 對訂單的管理、查詢與出貨流程控管。

此模組必須確保：
- 訂單僅在「玩家選擇出貨」後產生
- 訂單與店家強關聯，避免跨店資料外洩
- 訂單流程不可逆，防止作弊與爭議

---

## 2. 訂單產生規則

- 抽獎行為 **不會直接產生訂單**
- 玩家抽到的商品會先進入「賞品盒（類似購物車）」
- 玩家可在賞品盒中：
  - 檢視所有抽中的商品
  - 選擇要出貨的商品
- **只有當玩家從賞品盒送出出貨請求時，才會正式產生訂單**

> 系統中不存在「一抽一單」
> 所有訂單皆為玩家主動整合後送出

---

## 3. 訂單與店家關聯規則

- 每一筆訂單 **必須只屬於單一店家**
- 若玩家在不同店家抽獎：
  - 系統必須拆分為多筆訂單
  - 各店家僅能看到與自己相關的訂單
- 店家後台 **絕不可看到其他店家的訂單資料**

---

## 4. 店家後台可見內容

### 4.1 訂單列表

店家可查看屬於自己的訂單清單，包含但不限於：
- 訂單編號
- 訂單狀態
- 玩家資訊（必要最小化）
- 商品數量
- 出貨方式
- 建立時間

### 4.2 訂單明細

店家可進入單筆訂單查看：
- 訂單內商品清單
  - 商品名稱
  - 商品圖片
  - 抽獎來源
- 出貨資訊
  - 出貨方式（宅配 / 超商）
  - 收件資訊
- 備註資訊（若有）

---

## 5. 玩家在訂單流程中的行為限制

- 玩家可以：
  - 查看自己的訂單列表
  - 查看訂單狀態
  - 查看出貨資訊
- 玩家 **無法自行取消訂單**
- 若玩家想取消訂單：
  - 必須自行聯絡店家
  - 系統不提供玩家端取消功能

---

## 6. 訂單取消與不可逆規則（防作弊）

### 6.1 訂單取消規則

- 訂單僅能在「尚未出貨」狀態下取消
- **只有後台（店家或平台管理者）可以執行取消**
- 訂單一旦進入出貨流程後：
  - 不可取消
  - 不可退換貨

### 6.2 不可逆原則

- 訂單狀態只允許單向前進
- 不允許回退至前一狀態
- 所有狀態異動需保留紀錄（供後續查核）

---

## 7. 出貨狀態管理（狀態變更）

訂單需具備清楚的狀態流轉機制，至少包含以下概念狀態：

- 訂單成立（待處理）
- 準備出貨
- 已出貨
- 已完成
- 已取消（僅限未出貨前）

> 狀態變更僅能由後台操作  
> 玩家僅能查看狀態，不可修改

---

## 8. 平台角色與介入原則

- 平台 **不介入玩家與店家之間的交易行為**
- 平台角色僅限於：
  - 系統管理
  - 訂單資料查詢（必要時）
  - 異常狀況處理（非日常流程）

---

## 9. 與其他模組的關聯

- 訂單來源：
  - 來自「賞品盒（購物車）」模組
- 出貨資訊：
  - 與「運送管理」模組整合
- 金流資訊：
  - 與「金流管理」模組關聯（付款完成後訂單才成立）

---

## 10. 設計原則總結

- 抽獎 ≠ 訂單
- 出貨才產生訂單
- 訂單強制單店家關聯
- 訂單流程不可逆
- 玩家權限最小化
- 後台權限明確分層


