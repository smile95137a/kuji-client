# 角色設定
你是一位「資深系統分析師（SA）＋平台架構顧問」，
負責協助我撰寫一份【第三方一番賞整合平台】的正式需求文件。

請嚴格遵守以下規則：
- 只寫「需求文件」
- ❌ 不要寫 DB Table
- ❌ 不要寫 API
- ❌ 不要寫程式碼
- ❌ 不要寫技術實作細節
- ✅ 只描述「業務規則 / 行為 / 限制 / 流程」
- 語氣請專業、結構清楚，可直接交給工程師或 PM 使用

---

# 系統背景（固定，不可自行修改）

本系統為「第三方一番賞整合平台」，提供線下店家使用線上抽獎功能。

核心概念：
- 店家可建立自己的抽獎商品
- 玩家儲值點數後可進行線上抽獎
- 抽獎為「固定數量池、抽完即結束」模式
- 不使用機率制，每一抽為等概率（1/N）
- 系統需確保公平性、防止黑箱、避免同步抽獎衝突

角色說明（僅供理解）：
- 前台玩家（User）
- 後台角色：Admin / StoreOwner / StoreEditor

---

# 撰寫目標

請產出以下兩大章節的【完整需求文件 v1.0】：

1️⃣ 商品管理（Product Management）
2️⃣ 抽獎功能（Lottery / Gacha System）

請依照順序撰寫，章節需清楚分段。

---

# 第一章：商品管理（Product Management）

請包含以下內容：

## 1. 商品定位與定義
- 商品在系統中的角色
- 商品與店家的關係（不可跨店家共用）
- 商品與抽獎系統的關聯

## 2. 商品類型（固定）
以下類型為固定 Enum，不提供後台動態新增：
- 官方一番賞
- 扭蛋
- 卡牌
- 自製賞
  - 抽籤型
  - 刮刮樂型

## 3. 商品生命週期
請定義並說明以下狀態的意義與轉換條件：
- 草稿
- 已設定但未上架
- 已上架（未開抽）
- 可抽狀態
- 抽獎中
- 抽完（自動下架）
- 強制下架（Admin）

## 4. 商品時間控制
- 上架時間（可預約，自動上架）
- 開放抽獎時間（可能晚於上架）
- 抽獎結束條件（以抽完為主）
- 商品時間與前台顯示行為的關係

## 5. 商品操作權限（僅需求層）
說明：
- Admin 能做什麼
- StoreOwner 能做什麼
- StoreEditor 能做什麼
- 不同角色對「欄位 / 狀態」的限制

## 6. 商品排序與前台顯示
- 店家頁商品顯示邏輯
- 商品頁顯示邏輯
- 商品排序原則（依上架 / 開抽時間）
- 當月熱門商品排行榜（非 Banner）

## 7. 其他商品需求
- 商品複製
- 商品上下架（單筆 / 批量）
- 商品統計（抽獎次數、剩餘抽數）
- 即時抽況顯示（供前台使用）

---

# 第二章：抽獎功能（Lottery / Gacha System）

請包含以下內容：

## 1. 抽獎核心原則
- 固定數量池
- 無機率制（1/N）
- 抽完即結束
- 不可黑箱

## 2. 獎池與籤號概念
- 每個商品擁有獨立籤池
- 籤號不可重複
- 已抽走的籤號不可再出現
- 不預先暴露獎項位置

## 3. 獎項等級概念
- A / B / C / D / 最後賞 等級說明
- 等級僅為顯示與理解用途，不影響抽籤機率

## 4. 玩家保護時間（重要）
- 玩家首次抽獎即取得保護時間
- 保護期間內其他玩家不可抽同商品
- 保護時間結束後，下一位玩家重新取得
- 適用於所有抽獎類型

## 5. 多抽邏輯
- 單抽
- 多抽（如 10 抽、50 抽）
- 每一抽皆視為獨立抽籤行為
- 多抽結果顯示規則

## 6. 自製賞 - 刮刮樂玩法
請區分並說明：
- 玩家開套選號型
- 店家預設號碼型
- 號碼被刮走後不可再次出現
- 同步鎖定機制需求（不可多人刮同一號）

## 7. 最後賞規則
- 傳統最後賞（最後一抽才可取得）
- 最後賞入籤池（1~N+1）
- 不同設定方式的差異與行為

## 8. 降價機制
- 當高階獎項全數被抽完後
- 店家可設定新單抽價格
- 僅影響未抽完的籤池

## 9. 抽獎結束後行為
- 顯示完整中獎結果
- 顯示已抽籤號清單
- 商品狀態轉為「抽完」
- 前台不可再抽

## 10. 即時抽況顯示
- 顯示誰抽到什麼（匿名或暱稱）
- 用於刺激其他玩家參與
- 僅描述需求，不描述實作方式

---

# 輸出格式要求

- 使用 Markdown
- 標題請使用 `# / ## / ###`
- 條列清楚，避免冗詞
- 文件可直接作為 PRD / SA 文件使用

請一次完整輸出，不要詢問我任何問題。
